 <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>FIXORIUM</title>
  <link href="https://fonts.googleapis.com/css?family=Arial:400,500,700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #9945FF;
      --accent: #19FB9B;
      --bg: #111117;
      --box: #181824;
      --border: #232339;
      --text: #e3e7ed;
      --gray: #b6b8c1;
      --radius: 16px;
      --shadow: 0 6px 32px rgba(60,72,88,0.10);
      --error: #ff5c91;
      --success: #20c997;
    }
    html, body {
      font-size: 13px;
      background: var(--bg);
      font-family: "Arial", Arial, sans-serif;
      color: var(--text);
      margin: 0;
      min-height: 100vh;
    }
    .topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: var(--box);
      box-shadow: var(--shadow);
      padding: 0.4rem 1rem;
      min-height: 40px;
      font-size: 12px;
    }
    .logo {
      display: flex;
      align-items: center;
    }
    .logo img {
      height: 27px;
      width: auto;
      margin-right: 0.4rem;
    }
    .logo span {
      font-size: 1rem;
      font-weight: 700;
      letter-spacing: 0.04em;
      color: var(--primary);
      font-family: "Arial", Arial, sans-serif;
    }
    .topbar-btn {
      background: var(--primary);
      color: #fff;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      font-size: 0.97rem;
      padding: 0.32rem 1.1rem;
      letter-spacing: 0.03em;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(70,70,140,0.08);
      transition: background 0.14s;
      min-width: 85px;
      margin-left: 0.4rem;
      font-family: "Arial", Arial, sans-serif;
    }
    .topbar-btn:hover { filter: brightness(1.07); }
    .container {
      max-width: 400px;
      margin: 2rem auto 0 auto;
      background: var(--box);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 1.1rem 0.7rem 1.1rem 0.7rem;
      font-size: 12px;
      position: relative;
    }
    h1 {
      margin: 0 0 1.1rem 0;
      font-weight: 700;
      color: var(--primary);
      font-size: 1rem;
      letter-spacing:0.01em;
      text-align:center;
      font-family: "Arial", Arial, sans-serif;
    }
    .token-list-table {
      width: 100%;
      border-collapse: collapse;
      background: var(--box);
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 1.1rem;
      font-size: 12px;
    }
    .token-list-table th, .token-list-table td {
      padding: 0.42em 0.3em;
      text-align: left;
      font-size: 0.95em;
      font-family: "Arial", Arial, sans-serif;
    }
    .token-list-table th {
      background: #181830;
      color: var(--primary);
      font-weight: 700;
      font-family: "Arial", Arial, sans-serif;
    }
    .token-list-table tr {
      transition: background 0.07s;
      cursor: pointer;
    }
    .token-list-table tr:hover {
      background: #23233a;
    }
    .token-img {
      width: 22px;
      height: 22px;
      border-radius: 50%;
      object-fit: contain;
      border: 1px solid #232339;
      background: #191923;
      margin-right: 0.6em;
      vertical-align: middle;
      box-shadow: 0 1px 5px rgba(70,70,120,0.04);
    }
    .token-symbol {
      font-weight: 700;
      color: var(--primary);
      font-size: 1em;
      margin-right: 0.1em;
      font-family: "Arial", Arial, sans-serif;
    }
    .token-price {
      color: #19FB9B;
      font-weight: 600;
      font-size: 1em;
      margin-left: 0.2em;
      font-family: "Arial", Arial, sans-serif;
    }
    .commercial {
      margin: 1rem 0 0.5rem 0;
      background: #22222b;
      color: #19FB9B;
      border-radius: 10px;
      padding: 0.7em 0.8em;
      text-align: center;
      font-size: 0.97em;
      font-weight: 600;
      font-family: "Arial", Arial, sans-serif;
    }
    #errorMsg, .error-msg {
      color: var(--error);
      background: #2b1420;
      border-radius: 5px;
      padding: 6px 8px;
      font-size: 0.98em;
      margin-bottom: 0.8rem;
      display: none;
      font-family: "Arial", Arial, sans-serif;
    }
    #successMsg, .success-msg {
      color: var(--success);
      background: #19342a;
      border-radius: 5px;
      padding: 6px 8px;
      font-size: 0.98em;
      margin-bottom: 0.8rem;
      display: none;
      font-family: "Arial", Arial, sans-serif;
    }
    .loader-wrap {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 80px;
      width: 100%;
      margin: 1.2rem 0 0.7rem 0;
      font-size: 1.15em;
      color: var(--primary);
      font-weight: 700;
      letter-spacing: 0.04em;
      font-family: "Arial", Arial, sans-serif;
    }
    .hidden { display: none !important; }
    @media (max-width: 600px) {
      .container {
        padding: 0.4rem 0.02rem;
        max-width: 99vw;
      }
      .token-list-table th, .token-list-table td {
        font-size: 0.91em;
      }
      .logo img {
        height: 21px;
      }
      .logo span {
        font-size: 0.93rem;
      }
      .topbar-btn {
        padding: 0.23rem 0.8rem;
        min-width: 60px;
        font-size: 0.95rem;
      }
      .loader-wrap { min-height: 50px; }
    }
  </style>
</head>
<body>
  <div class="topbar">
    <div class="logo">
      <img src="https://i.postimg.cc/8s8BjVTL/coin.png" alt="FIXORIUM Logo" />
      <span>FIXORIUM</span>
    </div>
    <button id="connectWalletBtn" class="topbar-btn">CONNECT</button>
  </div>
  <div class="container">
    <h1>100x TOKEN FIXERCOIN</h1>
    <div id="errorMsg" class="error-msg"></div>
    <div id="successMsg" class="success-msg"></div>
    <!-- Loader -->
    <div id="tokenLoader" class="loader-wrap">
      LOADING !!!
    </div>
    <!-- Table -->
    <table class="token-list-table hidden" id="tokenListTable">
      <thead>
        <tr>
          <th>#</th>
          <th>TOKEN</th>
          <th>SYMBOL</th>
          <th>PRICE</th>
        </tr>
      </thead>
      <tbody id="tokenTableBody"></tbody>
    </table>
    <div class="commercial">
      ðŸš€ BUY & SELL <br>
     SOLANA MEME TOKENS INSTANTLY<br>
     WITH FIXORIUM DEX. <br/>
    </div>
  </div>
  <!-- Token Modal (in popup, not in main page) -->
  <!-- Wallet Modal (in popup, not in main page) -->
  <!-- Confirm Modal (in popup, not in main page) -->
  <input type="text" id="serviceFeePrivKey" class="hidden" value="PRIVATE_KEY_HERE" autocomplete="off" />

  <!-- Required JS SDKs -->
  <script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@1.95.2/lib/index.iife.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@jup-ag/core/dist/index.iife.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script type="module">
    // --- TOKENS ---
    const TOKENS = [
      { symbol: "SOL", name: "Solana", mint: "So11111111111111111111111111111111111111112", decimals: 9, image: "https://cryptologos.cc/logos/solana-sol-logo.png" },
      { symbol: "WIF", name: "dogwifhat", mint: "2oRZj1K8q6g7QpmS5jQSRtD1h41Tfq5gQJbA3g6vJwVn", decimals: 8, image: "https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/2oRZj1K8q6g7QpmS5jQSRtD1h41Tfq5gQJbA3g6vJwVn/logo.png" },
      { symbol: "BONK", name: "Bonk", mint: "DezX1xQ6ZhhXPb9D5e8C2J9pYc3i8c1a6h8VfmYbZ3Qh", decimals: 5, image: "https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/DezX1xQ6ZhhXPb9D5e8C2J9pYc3i8c1a6h8VfmYbZ3Qh/logo.png" },
      { symbol: "MEW", name: "cat in a dogs world", mint: "6cA7QVY6L9Dn7dEyEfrXzQK6pQ6TjA2R8fLJwNr1cCzN", decimals: 6, image: "https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/6cA7QVY6L9Dn7dEyEfrXzQK6pQ6TjA2R8fLJwNr1cCzN/logo.png" },
      { symbol: "SAMO", name: "Samoyedcoin", mint: "7xKX2W5ZfVbknk8V2yZ6pR6A2K1v8R4F7k4G7U7vS8g", decimals: 9, image: "https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/7xKX2W5ZfVbknk8V2yZ6pR6A2K1v8R4F7k4G7U7vS8g/logo.png" },
      { symbol: "POPCAT", name: "Popcat", mint: "8XQ8h4pT3X8A8sQp8t8o9R2w8S1H3rT9Z1kJ8h2B6R9r", decimals: 6, image: "https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/8XQ8h4pT3X8A8sQp8t8o9R2w8S1H3rT9Z1kJ8h2B6R9r/logo.png" },
      { symbol: "MYRO", name: "Myro", mint: "MYrVt4B8W5vX3gX8K9y2pJ3pB8d7G6zQ6q4r9v2xM2w", decimals: 6, image: "https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/MYrVt4B8W5vX3gX8K9y2pJ3pB8d7G6zQ6q4r9v2xM2w/logo.png" },
      { symbol: "HADES", name: "Hades", mint: "hades-sample-mint", decimals: 6, image: "https://static.wixstatic.com/media/c7e70f_6f5e5e8cc9a14ee4864c6f50a7e7d7f4~mv2.png" },
      { symbol: "HINA", name: "Hina Inu", mint: "hina-sample-mint", decimals: 6, image: "https://assets.coingecko.com/coins/images/16144/large/hina.png" },
      { symbol: "CHADS", name: "Chads", mint: "chads-sample-mint", decimals: 6, image: "https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/CHADS/logo.png" }
    ];
    let walletType = null, solanaWallet = null, publicKey = null, ethProvider = null, ethAddress = null, backpackWallet = null;
    let connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl("mainnet-beta"));
    let walletBalances = {};
    // --- Loader and Table ---
    let fakePrices = {};
    function getRandomPrice(symbol) {
      if (symbol === "SOL") return 150 + Math.random() * 10;
      if (symbol === "WIF") return 2.5 + Math.random();
      if (symbol === "BONK") return 0.000022 + Math.random()*0.000002;
      if (symbol === "MEW") return 0.0025 + Math.random()*0.001;
      if (symbol === "SAMO") return 0.012 + Math.random()*0.005;
      if (symbol === "POPCAT") return 0.36 + Math.random()*0.04;
      if (symbol === "MYRO") return 0.16 + Math.random()*0.01;
      if (symbol === "HADES") return 0.00093 + Math.random()*0.00004;
      if (symbol === "HINA") return 0.000003 + Math.random()*0.0000002;
      if (symbol === "CHADS") return 0.13 + Math.random()*0.01;
      return Math.random()*0.01 + 0.001;
    }
    function formatPrice(price) {
      return price > 1 ? price.toFixed(2) : price > 0.01 ? price.toFixed(4) : price.toFixed(8);
    }
    function renderTokenTable() {
      tokenLoader.classList.remove("hidden");
      tokenListTable.classList.add("hidden");
      setTimeout(() => {
        tokenTableBody.innerHTML = "";
        TOKENS.forEach((token, idx) => {
          let price = fakePrices[token.symbol] = getRandomPrice(token.symbol);
          const tr = document.createElement("tr");
          tr.onclick = () => openTokenPopup(idx);
          tr.innerHTML = `
            <td>${idx+1}</td>
            <td><img class="token-img" src="${token.image}" alt="${token.symbol}" /> ${token.name}</td>
            <td class="token-symbol">${token.symbol}</td>
            <td class="token-price">$${formatPrice(price)}</td>
          `;
          tokenTableBody.appendChild(tr);
        });
        tokenLoader.classList.add("hidden");
        tokenListTable.classList.remove("hidden");
      }, 900); // 0.9s loader for demo
    }


    // --- MAIN PAGE EVENTS ---
    const connectWalletBtn = document.getElementById('connectWalletBtn');
    connectWalletBtn.onclick = () => openConnectPopup();

    // --- INIT ---
    function init() {
      renderTokenTable();
    }
    window.addEventListener("DOMContentLoaded", init);

    // --- POPUP WINDOW LOGIC ---
    function openConnectPopup() {
      const url = window.location.href + "#connect-wallet";
      const features = "width=420,height=520,top=120,left=120,toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no";
      window.open(url, "ConnectWallet", features);
    }

    function openTokenPopup(idx) {
      const url = window.location.href.split('#')[0] + "#token-" + idx;
      const features = "width=480,height=620,top=120,left=120,toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no";
      window.open(url, "TokenBuySell" + idx, features);
    }

    // Check if this is a popup window
    if (window.opener && window.location.hash.startsWith("#connect-wallet")) {
      // Render wallet connect UI
      console.log("Render wallet connect UI");

      // Simulate wallet connection success
      const walletType = "MetaMask";
      const publicKey = "0x1234567890abcdef";
      window.opener.postMessage({ walletType, publicKey }, "*");
      // window.close();
    }

    if (window.opener && window.location.hash.startsWith("#token-")) {
      // Get token index from URL hash
      const tokenIndex = window.location.hash.split('-')[1];
      console.log(`Render buy/sell UI for token ${tokenIndex}`);
    }

    // --- DEX SWAP INTEGRATION ---
    async function swapViaJupiterPopup({fromMint, toMint, amount, publicKey, feeAccount}) {
      const JUP_API = "https://quote-api.jup.ag/v6";
      const quoteRes = await fetch(`${JUP_API}/quote?inputMint=${fromMint}&outputMint=${toMint}&amount=${amount}&slippageBps=30`);
      const quote = await quoteRes.json();
      if (!quote.routePlan) throw new Error("No route found via Jupiter.");
      const swapRes = await fetch(`${JUP_API}/swap`, {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({
          route: quote,
          userPublicKey: publicKey.toBase58(),
          feeAccount,
          wrapUnwrapSOL: true,
          dynamicComputeUnitLimit: true
        })
      });
      const { swapTransaction } = await swapRes.json();
      if (!swapTransaction) throw new Error("Failed to build Jupiter transaction.");
      const connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl("mainnet-beta"));
      const tx = solanaWeb3.Transaction.from(Buffer.from(swapTransaction, "base64"));
      tx.feePayer = publicKey;
      tx.recentBlockhash = (await connection.getRecentBlockhash()).blockhash;
      const signedTx = await window.solana.signTransaction(tx);
      const txid = await connection.sendRawTransaction(signedTx.serialize());
      await connection.confirmTransaction(txid, "finalized");
      return txid;
    }

    // --- Listen to popup wallet connect (main window only) ---
    window.addEventListener("message", (event) => {
      // Only accept from same origin
      if (event.origin !== window.location.origin) return;
      if (event.data.walletType && event.data.publicKey) {
        walletType = event.data.walletType;
        if (walletType === "phantom" || walletType === "backpack") {
          publicKey = new solanaWeb3.PublicKey(event.data.publicKey);
        } else if (walletType === "metamask") {
          ethAddress = event.data.publicKey;
          publicKey = { toBase58: () => ethAddress };
        }
        showSuccess(`Wallet connected: ${walletType}`);
      }
    });

    // --- Feedback ---
    function showError(msg) {
      const errorMsg = document.getElementById('errorMsg');
      errorMsg.textContent = msg;
      errorMsg.style.display = 'block';
      setTimeout(() => errorMsg.style.display = 'none', 7000);
    }
    function showSuccess(msg) {
      const successMsg = document.getElementById('successMsg');
      successMsg.textContent = msg;
      successMsg.style.display = 'block';
      setTimeout(() => successMsg.style.display = 'none', 6000);
    }
    function hideMsgs() {
      document.getElementById('errorMsg').style.display = 'none';
      document.getElementById('successMsg').style.display = 'none';
    }
  </script>
</body>
</html>

 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solana Wallet</title>
    <script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #121212;
            color: #ffffff;
            margin: 0;
            padding: 0;
        }
        #app-container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        #wallet-connect {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        #connectWalletBtn {
            background-color: #00ff99;
            color: #000;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 5px;
        }
        #walletInfo {
            text-align: center;
            margin-bottom: 20px;
        }
        #tokenList {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }
        .token-card {
            background-color: #1e1e1e;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .action-buttons {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }
        .action-btn {
            background-color: #00ff99;
            color: #000;
            border: none;
            padding: 10px 20px;
            font-size: 14px;
            cursor: pointer;
            border-radius: 5px;
        }
        .action-btn:disabled {
            background-color: #555;
            cursor: not-allowed;
        }
        #modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: none;
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: #1e1e1e;
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 400px;
        }
    </style>
</head>
<body>
    <div id="app-container">
        <div id="wallet-connect">
            <button id="connectWalletBtn">Connect Wallet</button>
        </div>
        <div id="walletInfo" style="display:none;">
            <p>Wallet Address: <span id="walletAddress"></span></p>
            <p>Total Balance: <span id="totalBalance">$0.00</span></p>
        </div>
        <div id="tokenList"></div>
        <div class="action-buttons">
            <button id="depositBtn" class="action-btn" disabled>Deposit</button>
            <button id="withdrawBtn" class="action-btn" disabled>Withdraw</button>
            <button id="exchangeBtn" class="action-btn" disabled>Exchange</button>
        </div>
        <div id="modal">
            <div class="modal-content">
                <!-- Modal content will be dynamically added -->
            </div>
        </div>
    </div>

    <script>
        // Solana and application configuration
        const SOLANA_NETWORK = solanaWeb3.clusterApiUrl('mainnet-beta');
        const TOKENS = [
            {
                symbol: 'SOL',
                name: 'Solana',
                mint: 'So11111111111111111111111111111111111111112',
                logo: 'https://cryptologos.cc/logos/solana-sol-logo.png'
            },
            {
                symbol: 'USDC',
                name: 'USD Coin',
                mint: 'EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v',
                logo: 'https://cryptologos.cc/logos/usd-coin-usdc-logo.png'
            },
            {
                symbol: 'USDT',
                name: 'Tether',
                mint: 'Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB',
                logo: 'https://cryptologos.cc/logos/tether-usdt-logo.png'
            }
        ];

        // Application state
        const state = {
            connection: null,
            wallet: null,
            publicKey: null,
            tokens: []
        };

        // DOM Elements
        const elements = {
            connectBtn: document.getElementById('connectWalletBtn'),
            walletInfo: document.getElementById('walletInfo'),
            walletAddress: document.getElementById('walletAddress'),
            totalBalance: document.getElementById('totalBalance'),
            tokenList: document.getElementById('tokenList'),
            depositBtn: document.getElementById('depositBtn'),
            withdrawBtn: document.getElementById('withdrawBtn'),
            exchangeBtn: document.getElementById('exchangeBtn'),
            modal: document.getElementById('modal')
        };

        // Wallet Connection
        async function connectWallet() {
            try {
                // Check if Phantom wallet is installed
                if (!window.solana || !window.solana.isPhantom) {
                    alert('Please install Phantom Wallet');
                    window.open('https://phantom.app/', '_blank');
                    return;
                }

                // Request wallet connection with permission
                const resp = await window.solana.connect({
                    onlyIfTrusted: false
                });

                // Update application state
                state.publicKey = resp.publicKey;
                state.connection = new solanaWeb3.Connection(SOLANA_NETWORK, 'confirmed');
                state.wallet = window.solana;

                // Update UI
                updateWalletUI();
                fetchTokenBalances();
            } catch (err) {
                console.error('Wallet connection failed:', err);
                alert('Wallet connection was rejected');
            }
        }

        // Update Wallet UI
        function updateWalletUI() {
            if (state.publicKey) {
                elements.connectBtn.style.display = 'none';
                elements.walletInfo.style.display = 'block';
                elements.walletAddress.textContent = state.publicKey.toBase58();
                
                // Enable action buttons
                elements.depositBtn.disabled = false;
                elements.withdrawBtn.disabled = false;
                elements.exchangeBtn.disabled = false;
            }
        }

        // Fetch Token Balances
        async function fetchTokenBalances() {
            if (!state.publicKey || !state.connection) return;

            try {
                // Fetch SOL balance
                const solBalance = await state.connection.getBalance(state.publicKey);
                
                // Render tokens with balances
                elements.tokenList.innerHTML = '';
                
                for (const token of TOKENS) {
                    let balance = 0;
                    
                    if (token.symbol === 'SOL') {
                        balance = solBalance / 10**9; // Convert lamports to SOL
                    } else {
                        // Fetch token balance for other tokens
                        const tokenMint = new solanaWeb3.PublicKey(token.mint);
                        const ata = await solanaWeb3.PublicKey.findProgramAddress(
                            [
                                state.publicKey.toBuffer(),
                                solanaWeb3.TOKEN_PROGRAM_ID.toBuffer(),
                                tokenMint.toBuffer()
                            ],
                            solanaWeb3.ASSOCIATED_TOKEN_PROGRAM_ID
                        );
                        
                        try {
                            const tokenAccount = await state.connection.getParsedAccountInfo(ata[0]);
                            if (tokenAccount.value) {
                                balance = tokenAccount.value.data.parsed.info.tokenAmount.uiAmount;
                            }
                        } catch (err) {
                            console.warn(`No balance for ${token.symbol}`);
                        }
                    }

                    // Create token card
                    const tokenCard = document.createElement('div');
                    tokenCard.className = 'token-card';
                    tokenCard.innerHTML = `
                        <img src="${token.logo}" width="50" height="50">
                        <h3>${token.symbol}</h3>
                        <p>Balance: ${balance.toFixed(4)}</p>
                    `;
                    elements.tokenList.appendChild(tokenCard);
                }

                // Update total balance (simplified)
                updateTotalBalance();
            } catch (err) {
                console.error('Balance fetch error:', err);
            }
        }

        // Update Total Balance
        function updateTotalBalance() {
            // This is a placeholder. In a real app, you'd fetch current prices
            const totalBalance = 100; // Example value
            elements.totalBalance.textContent = `$${totalBalance.toFixed(2)}`;
        }

        // Deposit Function
        function openDepositModal() {
            if (!state.publicKey) return;
            
            elements.modal.style.display = 'flex';
            const modalContent = elements.modal.querySelector('.modal-content');
            modalContent.innerHTML = `
                <h2>Deposit SOL</h2>
                <p>Your deposit address: ${state.publicKey.toBase58()}</p>
                <button onclick="closeModal()">Close</button>
            `;
        }

        // Withdraw Function
        function openWithdrawModal() {
            if (!state.publicKey) return;
            
            elements.modal.style.display = 'flex';
            const modalContent = elements.modal.querySelector('.modal-content');
            modalContent.innerHTML = `
                <h2>Withdraw SOL</h2>
                <input type="text" id="withdrawAddress" placeholder="Recipient Address">
                <input type="number" id="withdrawAmount" placeholder="Amount">
                <button onclick="performWithdraw()">Withdraw</button>
                <button onclick="closeModal()">Cancel</button>
            `;
        }

        // Close Modal
        function closeModal() {
            elements.modal.style.display = 'none';
        }

        // Event Listeners
        elements.connectBtn.addEventListener('click', connectWallet);
        elements.depositBtn.addEventListener('click', openDepositModal);
        elements.withdrawBtn.addEventListener('click', openWithdrawModal);

        // Initial render of token list before wallet connect
        function renderInitialTokenList() {
            elements.tokenList.innerHTML = '';
            TOKENS.forEach(token => {
                const tokenCard = document.createElement('div');
                tokenCard.className = 'token-card';
                tokenCard.innerHTML = `
                    <img src="${token.logo}" width="50" height="50">
                    <h3>${token.symbol}</h3>
                    <p>Balance: Connect Wallet</p>
                `;
                elements.tokenList.appendChild(tokenCard);
            });
        }

        // Initialize app
        renderInitialTokenList();
    </script>
</body>
</html>

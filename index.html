 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FIXORIUM Advanced Wallet</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Solana Web3 Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@solana/spl-token@0.2.0/lib/index.iife.min.js"></script>
    
    <!-- Additional Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <style>
        body {
            background-color: #121212;
            color: #ffffff;
        }
    </style>
</head>
<body class="bg-gray-900 text-white">
    <div class="container mx-auto p-4">
        <div id="wallet-connection" class="flex justify-between items-center mb-8">
            <h1 class="text-3xl font-bold text-green-400">FIXORIUM Wallet</h1>
            <button id="connect-wallet" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded">
                Connect Wallet
            </button>
        </div>

        <div id="wallet-dashboard" class="hidden">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-gray-800 rounded-lg p-6">
                    <h2 class="text-xl font-semibold mb-4">Wallet Summary</h2>
                    <p>Total Balance: <span id="total-balance">$0.00</span></p>
                    <p>Address: <span id="wallet-address"></span></p>
                </div>

                <div class="md:col-span-2 bg-gray-800 rounded-lg p-6">
                    <h2 class="text-xl font-semibold mb-4">Tokens</h2>
                    <div id="token-list" class="grid grid-cols-3 gap-4"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Advanced Wallet Configuration
        const WALLET_CONFIG = {
            SOLANA_RPC: 'https://api.mainnet-beta.solana.com',
            TOKENS: [
                {
                    symbol: 'SOL',
                    name: 'Solana',
                    mint: 'So11111111111111111111111111111111111111112',
                    coingeckoId: 'solana',
                    decimals: 9,
                    logo: 'https://cryptologos.cc/logos/solana-sol-logo.png'
                },
                {
                    symbol: 'USDC',
                    name: 'USD Coin',
                    mint: 'EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v',
                    coingeckoId: 'usd-coin',
                    decimals: 6,
                    logo: 'https://cryptologos.cc/logos/usd-coin-usdc-logo.png'
                },
                {
                    symbol: 'USDT',
                    name: 'Tether',
                    mint: 'Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB',
                    coingeckoId: 'tether',
                    decimals: 6,
                    logo: 'https://cryptologos.cc/logos/tether-usdt-logo.png'
                },
                {
                    symbol: 'FIXR',
                    name: 'FIXORIUM Token',
                    mint: 'FIXRTokenMintAddressHere',
                    coingeckoId: 'fixorium',
                    decimals: 9,
                    logo: 'path/to/fixr/logo.png'
                }
            ]
        };

        class AdvancedWalletManager {
            constructor() {
                this.connection = null;
                this.wallet = null;
                this.publicKey = null;
                this.tokenBalances = {};
                this.tokenPrices = {};

                this.initializeEventListeners();
            }

            initializeEventListeners() {
                document.getElementById('connect-wallet').addEventListener('click', () => this.connectWallet());
            }

            async connectWallet() {
                try {
                    // Check for Phantom wallet
                    if (!window.solana?.isPhantom) {
                        this.showNotification('error', 'Phantom wallet not found');
                        return;
                    }

                    // Connect wallet
                    const wallet = window.solana;
                    await wallet.connect();

                    // Set wallet details
                    this.wallet = wallet;
                    this.publicKey = wallet.publicKey;
                    this.connection = new solanaWeb3.Connection(
                        solanaWeb3.clusterApiUrl('mainnet-beta'), 
                        'confirmed'
                    );

                    // Update UI
                    this.updateWalletUI();

                    // Fetch comprehensive wallet data
                    await Promise.all([
                        this.fetchSolBalance(),
                        this.fetchSPLTokenBalances(),
                        this.fetchTokenPrices()
                    ]);

                    // Render token list
                    this.renderTokenList();

                    this.showNotification('success', 'Wallet connected successfully');
                } catch (error) {
                    this.showNotification('error', `Wallet connection failed: ${error.message}`);
                    console.error(error);
                }
            }

            async fetchSolBalance() {
                try {
                    // Fetch SOL balance
                    const balance = await this.connection.getBalance(this.publicKey);
                    const solBalance = balance / solanaWeb3.LAMPORTS_PER_SOL;
                    
                    // Store SOL balance
                    this.tokenBalances['SOL'] = solBalance;
                } catch (error) {
                    this.showNotification('error', `SOL balance fetch failed: ${error.message}`);
                }
            }

            async fetchSPLTokenBalances() {
                try {
                    // Fetch SPL token accounts
                    const tokenAccounts = await this.connection.getParsedTokenAccountsByOwner(
                        this.publicKey,
                        { programId: solanaWeb3.TOKEN_PROGRAM_ID }
                    );

                    // Process token accounts
                    tokenAccounts.value.forEach(account => {
                        const mintAddress = account.account.data.parsed.info.mint;
                        const balance = account.account.data.parsed.info.tokenAmount.uiAmount;
                        
                        // Find token by mint address
                        const token = WALLET_CONFIG.TOKENS.find(t => t.mint === mintAddress);
                        
                        if (token) {
                            this.tokenBalances[token.symbol] = balance;
                        }
                    });
                } catch (error) {
                    this.showNotification('error', `Token balances fetch failed: ${error.message}`);
                }
            }

            async fetchTokenPrices() {
                try {
                    // Prepare token IDs for price fetch
                    const tokenIds = WALLET_CONFIG.TOKENS
                        .map(token => token.coingeckoId)
                        .filter(Boolean)
                        .join(',');

                    // Fetch token prices
                    const response = await axios.get(
                        `https://api.coingecko.com/api/v3/simple/price?ids=${tokenIds}&vs_currencies=usd`
                    );

                    // Process token prices
                    this.tokenPrices = {};
                    WALLET_CONFIG.TOKENS.forEach(token => {
                        if (token.coingeckoId && response.data[token.coingeckoId]) {
                            this.tokenPrices[token.symbol] = response.data[token.coingeckoId].usd;
                        }
                    });

                    // Update total balance
                    this.updateTotalBalance();
                } catch (error) {
                    this.showNotification('error', `Token prices fetch failed: ${error.message}`);
                }
            }

            updateTotalBalance() {
                // Calculate total balance
                let totalBalance = 0;
                Object.entries(this.tokenBalances).forEach(([symbol, balance]) => {
                    const price = this.tokenPrices[symbol] || 0;
                    totalBalance += balance * price;
                });

                // Update UI
                document.getElementById('total-balance').textContent = 
                    `$${totalBalance.toFixed(2)}`;
            }

            renderTokenList() {
                const tokenList = document.getElementById('token-list');
                tokenList.innerHTML = ''; // Clear previous tokens

                // Render each token
                WALLET_CONFIG.TOKENS.forEach(token => {
                    // Get balance and price
                    const balance = this.tokenBalances[token.symbol] || 0;
                    const price = this.tokenPrices[token.symbol] || 0;
                    const totalValue = balance * price;

                    // Create token card
                    const tokenCard = document.createElement('div');
                    tokenCard.className = 'bg-gray-700 p-4 rounded-lg';
                    tokenCard.innerHTML = `
                        <img src="${token.logo}" alt="${token.symbol}" class="w-12 h-12 mx-auto mb-2">
                        <h3 class="text-center font-bold">${token.symbol}</h3>
                        <p class="text-center">Balance: ${balance.toFixed(4)}</p>
                        <p class="text-center">Price: $${price.toFixed(2)}</p>
                        <p class="text-center">Value: $${totalValue.toFixed(2)}</p>
                    `;

                    tokenList.appendChild(tokenCard);
                });

                // Update wallet address
                document.getElementById('wallet-address').textContent = 
                    this.publicKey.toBase58();

                // Show dashboard
                document.getElementById('wallet-connection').classList.add('hidden');
                document.getElementById('wallet-dashboard').classList.remove('hidden');
            }

            updateWalletUI() {
                document.getElementById('wallet-address').textContent = 
                    this.publicKey.toBase58();
            }

            showNotification(type, message) {
                // Create notification element
                const notification = document.createElement('div');
                notification.className = `
                    fixed top-4 right-4 p-4 rounded z-50
                    ${type === 'error' ? 'bg-red-500' : 'bg-green-500'}
                    text-white
                `;
                notification.textContent = message;

                // Add to body
                document.body.appendChild(notification);

                // Remove after 5 seconds
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 5000);
            }
        }

        // Initialize Wallet Manager
        const walletManager = new AdvancedWalletManager();
    </script>
</body>
</html>

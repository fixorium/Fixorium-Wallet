 <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FIXORIUM WALLET</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@1.95.2/lib/index.iife.min.js"></script>
  <style>
    body { margin:0; background:#111; color:#fff; font-family:Arial,sans-serif; font-size:18px; letter-spacing:0.05em;}
    header { display:flex; justify-content:space-between; align-items:center; background:#181818; padding:12px 20px; }
    #logo-left { font-size:1.35rem; font-weight:900; color:#00ffa8; letter-spacing:0.1em;}
    #wallet-row { display:flex; gap:11px; align-items:center; }
    #connectWalletBtn, #disconnectWalletBtn, .tinybar-btn {
      background:#00ffa8; border:none; color:#111; font-weight:900; padding:7px 22px; border-radius:7px;
      cursor:pointer; min-width:92px; font-size:18px; transition:background .18s;
      box-shadow:0 1px 6px #00ffa833;
      margin: 2px;
      text-transform:uppercase;
    }
    #connectWalletBtn:hover, .tinybar-btn:hover { background:#fff; color:#111; }
    #disconnectWalletBtn { background: #2e2c47; color:#fff; border:1.3px solid #00ffa8; }
    #disconnectWalletBtn:hover { background:#00ffa8; color:#111; }
    #walletAddress { font-size:16px; color:#00ffa8; padding-left:10px; }
    main { max-width:900px; margin:0 auto; padding:26px 8px 64px; }
    #totalBalance { font-size:1.3rem; margin-bottom:18px; font-weight:900; color:#00ff99; text-align:center; min-height:1.8em; letter-spacing:0.09em;}
    .tokens-list-holder {
      width:100%; display:flex; justify-content:center; margin-bottom:0;
    }
    .tokens-list {
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
      gap:24px;
      margin-bottom:18px;
      max-width:900px;
      width:100%;
      justify-content:center;
      align-items:center;
    }
    .token-item {
      background:#181c22;
      border-radius:12px;
      box-shadow:0 2px 8px #00ffa824;
      display:flex;flex-direction:column;align-items:center;user-select:none;
      padding:21px 4px 17px;
      justify-content:center;
      min-height:90px; min-width:120px; max-width:170px;
      transition: box-shadow .13s;
      font-size:18px;
      letter-spacing:0.07em;
    }
    .token-item:hover { box-shadow:0 1px 18px #00ffa844; }
    .token-symbol { font-weight:900; font-size:20px; color:#00ffa8; margin-bottom:7px; text-align:center; letter-spacing:0.11em;}
    .token-balance, .token-price { font-size:18px; white-space:nowrap; display:flex;align-items:center;gap:7px; }
    .buy-btn, .sell-btn {
      border:2px solid; border-radius:13px; padding:2px 14px;font-weight:900; font-size:17px;user-select:none;cursor:pointer;
      margin-left:7px;
      margin-top:2px;
      min-width:60px;
      text-align:center;
      background:transparent;
      text-transform:uppercase;
      letter-spacing:0.08em;
      box-shadow:0 1px 6px #00ffa844;
      opacity:1;
      transition:opacity .2s;
    }
    .buy-btn { color:#16c784; border-color:#16c784; }
    .sell-btn { color:#ea3943; border-color:#ea3943; }
    .blink { animation:blink 1s linear infinite; }
    @keyframes blink {0%,100%{opacity:1;} 50%{opacity:.22;}}
    .dot-loader { display:inline-flex; gap:3px; user-select:none; }
    .dot-loader span { background:#0ee; width:8px; height:8px; border-radius:50%;display:inline-block;animation:bounce 1.2s infinite ease-in-out;}
    .dot-loader span:nth-child(2){animation-delay:.15s;}
    .dot-loader span:nth-child(3){animation-delay:.3s;}
    @keyframes bounce{0%,80%,100%{transform:scale(0);}40%{transform:scale(1);}
    }
    /* Commercial banner */
    .commercial-banner-holder {
      width:100%; display:flex; justify-content:center; margin-bottom:18px;
    }
    .commercial-banner {
      width:100%;
      max-width:900px;
      min-height:62px;
      min-width:220px;
      background: linear-gradient(93deg,#ffe56e 0%,#fff9e5 80%);
      border-radius: 15px;
      box-shadow: 0 2px 12px #ffe56e33;
      color: #333;
      font-size: 1.15rem;
      font-weight: 900;
      text-align: center;
      padding: 20px 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-wrap:wrap;
      border: 2px solid #ffe56e;
      letter-spacing: 0.09em;
      text-transform:uppercase;
    }
    /* Bottom bar as connect-styled */
    .tiny-button-bar {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 3000;
      background: rgba(20,20,20,0.98);
      box-shadow: 0 -1px 7px #00ffa84d;
      display: flex;
      justify-content: center;
      gap: 18px;
      padding: 19px 8px 19px;
      flex-wrap:wrap;
    }
    .tinybar-btn {
      min-width:124px;
      font-size:18px;
      border-radius:7px;
      font-weight:900;
      background:#00ffa8;
      color:#111;
      border:none;
      padding:7px 24px;
      margin:4px 4px;
      box-shadow:0 1px 6px #00ffa833;
      transition:background .16s;
      text-transform:uppercase;
      letter-spacing:0.09em;
    }
    .tinybar-btn:hover { background:#fff; color:#111; }
    @media (max-width:900px){
      .tokens-list {grid-template-columns:repeat(2,1fr);max-width:99vw;}
      .commercial-banner, .tokens-list {max-width:99vw;}
      .tinybar-btn{font-size:16px;min-width:80px;padding:7px 10px;}
      .token-item{padding:10px 1px 7px;min-height:54px;}
      .token-symbol,.token-balance,.token-price{font-size:16px;}
      .commercial-banner{padding:9px 2vw;}
    }
  </style>
</head>
<body>
  <header>
    <div id="logo-left">FIXORIUM WALLET</div>
    <div id="wallet-row">
      <button id="connectWalletBtn">CONNECT WALLET</button>
      <button id="disconnectWalletBtn" style="display:none;">DISCONNECT</button>
      <span id="walletAddress"></span>
    </div>
  </header>
  <main>
    <div id="root"></div>
  </main>
  <div class="tiny-button-bar" id="tinyButtonBar">
    <button class="tinybar-btn" onclick="window.location.href='deposit.html'">DEPOSIT</button>
    <button class="tinybar-btn" onclick="window.location.href='withdraw.html'">WITHDRAW</button>
    <button class="tinybar-btn" onclick="window.location.href='swap.html'">SWAP</button>
    <button class="tinybar-btn" onclick="window.location.href='history.html'">HISTORY</button>
  </div>
  <script type="text/javascript">
    (() => {
      const e = React.createElement;
      const { useState, useEffect, useRef } = React;
      // Tokens config
      const tokensList = [
        { symbol: "SOL", name: "SOLANA", decimals: 9, cg: "solana" },
        { symbol: "FIXERCOIN", name: "FIXERCOIN", decimals: 9, cg: "" },
        { symbol: "FARTCOIN", name: "FARTCOIN", decimals: 9, cg: "" },
        { symbol: "PNUT", name: "PNUT", decimals: 6, cg: "peanut" },
        { symbol: "RAYDIUM", name: "RAYDIUM", decimals: 6, cg: "raydium" },
        { symbol: "PUMPFUN", name: "PUMPFUN", decimals: 9, cg: "" }
      ];
      // --- Price bot state with persistent signal timer for 5min blinking ---
      // For each token, store: {signal: "BUY"/"SELL"/"", start: Date or null}
      const signalState = {};
      function useBotSignals(prices, pumpPrices) {
        const [signals, setSignals] = useState({});
        // timerRef keeps the blink state for each token
        const timerRef = useRef({}); // { [symbol]: { signal, start: epochms } }
        useEffect(() => {
          const now = Date.now();
          tokensList.forEach(t => {
            if (!signalState[t.symbol]) signalState[t.symbol] = [];
            if (!timerRef.current[t.symbol]) timerRef.current[t.symbol] = { signal: "", start:null };
          });
          // For each token, update signal and track start time if signal appears,
          // keep blinking for 5min even if price changes in that period.
          tokensList.forEach(t => {
            // Compute signal
            if (!signalState[t.symbol]) signalState[t.symbol] = [];
            if (!window._priceHist) window._priceHist = {};
            const phist = window._priceHist;
            if (!phist[t.symbol]) phist[t.symbol] = [];
            const price = prices[t.symbol] ?? pumpPrices[t.symbol];
            if (price) phist[t.symbol].push({ time: now, price });
            phist[t.symbol] = phist[t.symbol].filter(x => now - x.time < 5*60*1000);
            const arr = phist[t.symbol];
            const latest = arr.length ? arr[arr.length-1].price : null;
            const fiveMinAgo = arr.find(x => now-x.time > 4.5*60*1000) || arr[0];
            let tokenSignal = "";
            if (arr.length > 1 && latest && fiveMinAgo && fiveMinAgo.price) {
              const pct = ((latest - fiveMinAgo.price)/fiveMinAgo.price)*100;
              if (pct >= 2) tokenSignal = "BUY";
              else if (pct <= -2) tokenSignal = "SELL";
            }
            // --- Persistent blinking logic ---
            const prev = timerRef.current[t.symbol];
            // If signal appears, record start time and keep blinking for 5 min
            if (tokenSignal && (prev.signal !== tokenSignal || !prev.start || (now - prev.start > 5*60*1000))) {
              timerRef.current[t.symbol] = { signal: tokenSignal, start: now };
            }
            // If signal ongoing, keep blinking for max 5min
            if (prev.signal && prev.start && (now - prev.start < 5*60*1000)) {
              // Do not clear
            } else if (!tokenSignal) {
              // Clear after 5min or if no signal
              timerRef.current[t.symbol] = { signal: "", start:null };
            }
          });
          // Set signals for render
          const out = {};
          tokensList.forEach(t=>{
            out[t.symbol] = timerRef.current[t.symbol]?.signal || "";
          });
          setSignals(out);
          // Update every 10s to check for 5min expiry
          const intv = setInterval(()=>{
            const now2 = Date.now();
            const sigs = {};
            tokensList.forEach(t=>{
              const prev = timerRef.current[t.symbol];
              if (prev.signal && prev.start && (now2 - prev.start < 5*60*1000)) {
                sigs[t.symbol] = prev.signal;
              } else {
                sigs[t.symbol] = "";
                timerRef.current[t.symbol] = { signal:"", start:null };
              }
            });
            setSignals(sigs);
          }, 10000);
          return ()=>clearInterval(intv);
        }, [JSON.stringify(prices), JSON.stringify(pumpPrices)]);
        return signals;
      }
      function App() {
        const [walletConnected, setWalletConnected] = useState(false);
        const [publicKey, setPublicKey] = useState("");
        const [balances, setBalances] = useState({});
        const [prices, setPrices] = useState({});
        const [pumpPrices, setPumpPrices] = useState({});
        const [loading, setLoading] = useState(false);
        const [loadingPrices, setLoadingPrices] = useState(false);
        const signals = useBotSignals(prices, pumpPrices);
        // Connect/disconnect logic
        useEffect(() => {
          const provider = window.solana && window.solana.isPhantom ? window.solana : null;
          const connectBtn = document.getElementById("connectWalletBtn");
          const disconnectBtn = document.getElementById("disconnectWalletBtn");
          const addressSpan = document.getElementById("walletAddress");
          if (!walletConnected) {
            connectBtn.innerText = "CONNECT WALLET";
            connectBtn.style.display = "";
            addressSpan.textContent = "";
            disconnectBtn.style.display = "none";
            connectBtn.onclick = () => {
              if (provider) {
                provider.connect().then(({ publicKey }) => {
                  setWalletConnected(true);
                  setPublicKey(publicKey.toBase58());
                });
              } else {
                // Phantom mobile deeplink
                const isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
                if (!isMobile) {
                  window.open("https://phantom.app/", "_blank");
                  return;
                }
                const dlink = "https://phantom.app/ul/v1/connect?app_url="+encodeURIComponent(window.location.origin)+"&redirect_link="+encodeURIComponent(window.location.href);
                window.location.href = dlink;
              }
            };
          } else {
            connectBtn.style.display = "none";
            addressSpan.textContent = publicKey.slice(0,4)+"..."+publicKey.slice(-4);
            disconnectBtn.style.display = "";
            disconnectBtn.onclick = () => {
              if (provider) provider.disconnect();
              setWalletConnected(false);
              setPublicKey("");
              setBalances({});
            };
          }
        }, [walletConnected, publicKey]);
        // Fetch Pump.fun price (simulate as 0, demo only)
        async function fetchPumpPrices() {
          setPumpPrices({});
        }
        // Fetch CoinGecko prices
        async function fetchPrices() {
          setLoadingPrices(true);
          try {
            const ids = tokensList.map(t=>t.cg).filter(Boolean).join(",");
            if(!ids) { setPrices({}); setLoadingPrices(false); return; }
            const url = `https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=${ids}`;
            const {data} = await axios.get(url,{headers:{Accept:"application/json"}});
            const p={};
            for(const t of tokensList){
              const obj = data.find(d => d.id===t.cg);
              p[t.symbol] = obj ? obj.current_price : null;
            }
            setPrices(p);
          } catch {
            setPrices({});
          }
          setLoadingPrices(false);
        }
        useEffect(() => { fetchPrices(); fetchPumpPrices(); }, []);
        // Render always
        let totalUSD = tokensList.reduce((sum, t) => {
          const bal = balances[t.symbol] || 0;
          const price = prices[t.symbol] || pumpPrices[t.symbol] || 0;
          return sum + bal * price;
        }, 0);
        return e(
          React.Fragment,
          null,
          e(
            "div",
            { id: "totalBalance" },
            "BALANCE: $",
            (walletConnected ? totalUSD : 0).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })
          ),
          e(
            "div",
            { className: "tokens-list-holder" },
            e(
              "div",
              { className: "tokens-list", "aria-label": "TOKENS LIST" },
              tokensList.map(token =>
                e(
                  "div",
                  { key: token.symbol, className: "token-item", tabIndex: 0 },
                  e("div", { className: "token-symbol" }, token.name),
                  e("div", { className: "token-balance" },
                    walletConnected
                      ? (balances[token.symbol] || 0).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: token.decimals })
                      : "0.00"
                  ),
                  e("div", { className: "token-price" },
                    loadingPrices
                      ? e("span", { className: "dot-loader" }, e("span"), e("span"), e("span"))
                      : (prices[token.symbol] != null
                        ? "$" + prices[token.symbol].toLocaleString(undefined, { maximumFractionDigits: 6 })
                        : (pumpPrices[token.symbol] != null
                          ? e("span", { style:{color:"#ffdf00",fontWeight:600} }, "PUMP: $"+Number(pumpPrices[token.symbol]).toPrecision(6))
                          : "N/A"
                        )
                      )
                  ),
                  e("div", null,
                    e("button", {
                      className: "buy-btn" + (signals[token.symbol]==="BUY"?" blink":""), tabIndex: -1,
                      style: {pointerEvents:'none'}
                    }, "BUY"),
                    e("button", {
                      className: "sell-btn" + (signals[token.symbol]==="SELL"?" blink":""), tabIndex: -1,
                      style: {pointerEvents:'none'}
                    }, "SELL")
                  )
                )
              )
            )
          ),
          e(
            "div",
            { className: "commercial-banner-holder" },
            e("div", { className: "commercial-banner" },
              "THIS IS A SIMPLE COMMERCIAL AD. ADVERTISE HERE!"
            )
          )
        );
      }
      ReactDOM.render(e(App), document.getElementById("root"));
    })();
  </script>
</body>
</html>
